
<h1>Liệt kê các sản phẩm</h1>
<% if current_user.try(:admin?) %>
<%= link_to 'Sản phẩm mới', new_product_path %>
<% end %><br>
<%= page_entries_info @products %>
<%= paginate @products %>
<table border="1">
  <tr>
    <th>id sản phẩm:</th>
    <th>Tên Sản Phẩm:</th> 
    <th>Avatar:</th>  
    <th>Images:</th>  
    <th>Giá bán:</th>
    <th>Giá gốc:</th>
    <th>Màu - color:</th>
    <th>Dòng franchise:</th>
    <th>Loại producttype:</th>
    <th>Nhãn brand:</th>
    <th>Danh mục category:</th>
    <th>Môn sport:</th>
    <th>sku:</th>
    
</tr>

<% @products.each do |product| %>
<tr>

    <td><%= product.id %></td>
    <td><%= product.productname %></td>
    <td><%= image_tag product.avatar, :height => "100",:width=>"100" %></td>
    <td>
        <% product.images.each do |image| %>
        <%= image_tag image , :height => "40",:width=>"40" %>
        <% end %> 
    </td>
    <td><%= product.price %></td>
    <td><%= product.originalpride %></td>
    <td>
        <%= product.subcolor_id && product.color_id  ? product.color.subcolors.find(product.subcolor_id).subcolor_name : '' %>
        <%= !product.subcolor_id && product.color_id  ? product.color.color_name : '' %>  
        <%= !product.subcolor_id && !product.color_id  ? '' : '' %> 
        <%= product.subcolor_id && !product.color_id  ?  'có subcolor nhưng ko có color' : '' %> 
    </td>

    <td><%= product.franchise_id ? product.franchise.franchise_name: '' %></td>
    <td><%= product.producttype_id ? product.producttype.producttype_name: '' %></td>
    <td><%= product.brand_id ? product.brand.brand_name: '' %></td>
    <td>
        <%= product.subcategory_id && product.category_id  ? product.category.subcategories.find(product.subcategory_id).subcategory_name : '' %>
        <%= !product.subcategory_id && product.category_id  ? product.category.category_name : '' %>  
        <%= !product.subcategory_id && !product.category_id  ? '' : '' %> 
        <%= product.subcategory_id && !product.category_id  ?  'có subcategory nhưng ko có category' : '' %> 
    </td>
    <td><%= product.sport_id ? product.sport.sport_name: '' %></td>
    <td><%= product.sku %></td>
    <td><%= link_to 'Xem', product_path(product) %></td>
    <% if current_user.try(:admin?) %>
    <td><%= link_to 'Sửa', edit_product_path(product) %></td>
    <td><%= link_to 'Xóa', product_path(product),
    method: :delete,
    data: { confirm: 'Bạn có chắc không?' } %></td>
    <% end %>
</tr>
<% end %>
</table>
<br>
<%= link_to 'Trở lại', root_path %>